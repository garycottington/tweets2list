/*
 * jQuery Tweets2List v0.3.2 - 17 December, 2012
 *
 * TERMS OF USE - jQuery Tweets2List
 * 
 * Open source under the BSD License. 
 * 
 * Copyright Â© Gary Cottington
 * All rights reserved.
 * Author - Gary Cottington (garycottington.co.uk)
 * 
 * Redistribution and use in source and binary forms, with or without modification, 
 * are permitted provided that the following conditions are met:
 * 
 * Redistributions of source code must retain the above copyright notice, this list of 
 * conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice, this list 
 * of conditions and the following disclaimer in the documentation and/or other materials 
 * provided with the distribution.
 * 
 * Neither the name of the author nor the names of contributors may be used to endorse 
 * or promote products derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY 
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED 
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED 
 * OF THE POSSIBILITY OF SUCH DAMAGE. 
 *
*/

function Tweets2List(){var e=0;var t;var n;var r=0;var s;var o;var u;var a=false;var f=navigator.userAgent.toLowerCase().indexOf("msie 7")>-1;var l=20;var c=10;var h="Twitter feed is unavailable.";var p="Loading Tweets...";var d=2e3;var v=true;var m=true;var g=true;var y=true;var b=true;var w=true;var E=2e4;var S="en";var x=true;Date.prototype.getMonthNameShort=function(e){e=e&&e in Date.locale?e:"en";return Date.locale[e].month_names_short[this.getMonth()]};Date.locale={en:{month_names_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};this.clear=function(e,t){$("#"+o+" .tweets2list_header").remove();$("#"+o+" .tweets2list_content").remove();$("#"+o+" .tweets2list_footer").remove()};this.connect=function(e,t){s=e;o=t;if($("#"+s).length>0&&$("#"+o).length>0){a=true}else{A("Connect failed. One or both of the divs specified are not present.")}$("#"+o).append('<div class="tweets2list_loading">'+p+"</div>")};this.get=function(){if(a){n=setInterval(function(){r++;e=T();if(e>0){clearInterval(n);if(l>e){l=e}$("#"+o+" .tweets2list_loading").remove();k();C();L();t=setInterval(function(){N()},E)}if(r>c){clearInterval(n);$("#"+o).html(h)}},d)}else{A("Call to get() failed. A valid connect() has not been established.")}};var T=function(){if(f){return $("#"+s+" iframe").contents().find("#twitter-widget-0 li.tweet").length}else{return $("#"+s+" iframe").contents().find("li.tweet").length}};var N=function(){var t;var n=new Date;var r;var a;var c;var h;var p;var d;var v="";var m=false;var g=$(".tweets2list_tweets li.tweet");for(i=1;i<=l;i++){t=g.eq(i-1).find("a.permalink").data("datetime");if(g.eq(i-1).find("a.permalink abbr").length>0){m=true}else{m=false}if(m){r=O(t);v=String(r.getDate())+" "+r.getMonthNameShort(S);a=n-r;c=Math.round(a/(1e3*60*60*24));if(c<=1){h=Math.floor(Math.abs(a/1e3));p=Math.floor(h/60);d=Math.floor(p/60);if(h<60){v=h+'<abbr title="seconds">s</abbr>'}else if(p<60){v=p+'<abbr title="minutes">m</abbr>'}else if(d<24){v=d+'<abbr title="hours">h</abbr>'}}if(g.eq(i-1).find("a.permalink time").length>0){g.eq(i-1).find("a.permalink time").html(v)}else{g.eq(i-1).find("a.permalink").html(v)}}else{break}}var y;var b="";var w="";var E=false;var N;var C=0;e=T();var g;if(f){g=$("#"+s+" iframe").contents().find("#twitter-widget-0 li.tweet")}else{g=$("#"+s+" iframe").contents().find("li.tweet")}if(x){for(i=1;i<=e;i++){y=g.eq(i-1).data("tweet-id");if(i==1){N=y}if(y==u){break}else{b=g.eq(i-1).html();if(b.length>0){E=true;C++;w=w+'<li class="tweet" data-tweet-id="'+y+'">'+b+'<div style="clear:both;"></div></li>'}}}if(E){u=N;$("#"+o+" .tweets2list_tweets").prepend(w);l=l+C}}};var C=function(){var e='<ol class="tweets2list_tweets">';var t="";var n;var r;if(f){r=$("#"+s+" iframe").contents().find("#twitter-widget-0 li.tweet")}else{r=$("#"+s+" iframe").contents().find("li.tweet")}for(i=1;i<=l;i++){t=r.eq(i-1).html();n=r.eq(i-1).data("tweet-id");if(t){e=e+'<li class="tweet" data-tweet-id="'+n+'">'+t+'<div style="clear:both;"></div></li>'}if(i==1){u=n}}e=e+"</ol>";e='<div class="tweets2list_content">'+e+"</div>";if(!y){e=e.replace(/<time/g,'<time style="display:none;"')}if(!b){e=e.replace(/<div class="footer/g,'<div style="display:none;" class="footer')}if(!w){e=e.replace(/<div class="header/g,'<div style="display:none;" class="header')}$("#"+o).append(e)};var k=function(){var e="";var t="block";if(!m){t="none"}if(f){e=$("#"+s+" iframe").contents().find("#twitter-widget-0 .timeline-header h1").html()}else{e=$("#"+s+" iframe").contents().find(".timeline-header h1").html()}e='<div class="tweets2list_header" style="display:'+t+';"><h2>'+e+"</h2></div>";$("#"+o).append(e)};var L=function(){var e="";var t="block";if(!m){t="none"}if(f){e=$("#"+s+" iframe").contents().find("#twitter-widget-0 .timeline-footer").html()}else{e=$("#"+s+" iframe").contents().find(".timeline-footer").html()}e='<div class="tweets2list_footer" style="display:'+t+';">'+e+"</div>";$("#"+o).append(e)};var A=function(e){if(v){alert("Tweet2List error: "+e)}};var O=function(e){var t="([0-9]{4})(-([0-9]{2})(-([0-9]{2})"+"(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?"+"(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?";var n=e.match(new RegExp(t));var r=0;var i;var s=new Date(n[1],0,1);if(n[3]){s.setMonth(n[3]-1)}if(n[5]){s.setDate(n[5])}if(n[7]){s.setHours(n[7])}if(n[8]){s.setMinutes(n[8])}if(n[10]){s.setSeconds(n[10])}if(n[12]){s.setMilliseconds(Number("0."+n[12])*1e3)}if(n[14]){r=Number(n[16])*60+Number(n[17]);r*=n[15]=="-"?1:-1}r-=s.getTimezoneOffset();i=Number(s)+r*60*1e3;s.setTime(Number(i));return s};this.set=function(e,t){switch(e){case"actions":if(t==false){b=false;$("#"+o+" .tweets2list_tweets li .footer").hide()}else{b=true;$("#"+o+" .tweets2list_tweets li .footer").show()}break;case"date":if(t==false){y=false;$("#"+o+" .tweets2list_tweets time").hide()}else{y=true;$("#"+o+" .tweets2list_tweets time").show()}break;case"footer":if(t==false){g=false;$("#"+o+" .tweets2list_footer").hide()}else{g=true;$("#"+o+" .tweets2list_footer").show()}break;case"header":if(t==false){m=false;$("#"+o+" .tweets2list_header").hide()}else{m=true;$("#"+o+" .tweets2list_header").show()}break;case"language":S=t;break;case"loading_message":p=t;break;case"loading_attempts":if($.isNumeric(t)){c=t}else{A(e+" must be assigned a numeric value.")}break;case"loading_timer":if($.isNumeric(t)){d=t}else{A(e+" must be assigned a numeric value.")}break;case"profile":if(t==false){w=false;$("#"+o+" .tweets2list_tweets .header").hide()}else{w=true;$("#"+o+" .tweets2list_tweets .header").show()}break;case"quantity":if($.isNumeric(t)){if(t<1){l=1}else if(t>20){l=20}else{l=t}}else{A(e+" must be assigned a numeric value between 1 and 20.")}break;case"refresh":if(t==false){x=false}else{x=true}break;case"twitter_down":h=t;break;case"update_timer":if($.isNumeric(t)){E=t}else{A(e+" must be assigned a numeric value.")}break;case"verbose":if(t==false){v=false}else{v=true}break;default:A(e+" is not a valid property.");break}}}